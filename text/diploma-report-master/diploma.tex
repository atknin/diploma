\documentclass[pdftex,a4paper,14pt,english,russian]{extarticle}

\usepackage[top=2cm,bottom=27mm,left=3cm,right=18mm]{geometry}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[pdftex]{hyperref}
\usepackage{indentfirst}
\usepackage{titlesec}
\usepackage[pdftex]{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\newcommand*\Laplace{\mathop{}\!\mathbin\bigtriangleup}
\usepackage[makeroom]{cancel}
\usepackage{ragged2e}

\usepackage{multirow}
\usepackage{algorithmic}
\usepackage[boxed]{algorithm}
\usepackage{tabularx}
\usepackage{xtab}
\usepackage{subfig}
\usepackage{hyphenat}
\usepackage{setspace}
\usepackage{fancyhdr}




% код программы - Листинг
\usepackage[usenames, dvipsnames]{color}
\definecolor{mygreen}{rgb}{0,0.6,0}
\usepackage{listings}
 \lstset{commentstyle=\color{mygreen},
 literate=
 	{~}{{\textasciitilde}}1
 	{а}{{\selectfont\char224}}1
 	{б}{{\selectfont\char225}}1
 	{в}{{\selectfont\char226}}1
 	{г}{{\selectfont\char227}}1
 	{д}{{\selectfont\char228}}1
 	{е}{{\selectfont\char229}}1
 	{ё}{{\"e}}1
 	{ж}{{\selectfont\char230}}1
 	{з}{{\selectfont\char231}}1
 	{и}{{\selectfont\char232}}1
 	{й}{{\selectfont\char233}}1
 	{к}{{\selectfont\char234}}1
 	{л}{{\selectfont\char235}}1
 	{м}{{\selectfont\char236}}1
 	{н}{{\selectfont\char237}}1
 	{о}{{\selectfont\char238}}1
 	{п}{{\selectfont\char239}}1
 	{р}{{\selectfont\char240}}1
 	{с}{{\selectfont\char241}}1
 	{т}{{\selectfont\char242}}1
 	{у}{{\selectfont\char243}}1
 	{ф}{{\selectfont\char244}}1
 	{х}{{\selectfont\char245}}1
 	{ц}{{\selectfont\char246}}1
 	{ч}{{\selectfont\char247}}1
 	{ш}{{\selectfont\char248}}1
 	{щ}{{\selectfont\char249}}1
 	{ъ}{{\selectfont\char250}}1
 	{ы}{{\selectfont\char251}}1
 	{ь}{{\selectfont\char252}}1
 	{э}{{\selectfont\char253}}1
 	{ю}{{\selectfont\char254}}1
 	{я}{{\selectfont\char255}}1
 	{А}{{\selectfont\char192}}1
 	{Б}{{\selectfont\char193}}1
 	{В}{{\selectfont\char194}}1
 	{Г}{{\selectfont\char195}}1
 	{Д}{{\selectfont\char196}}1
 	{Е}{{\selectfont\char197}}1
 	{Ё}{{\"E}}1
 	{Ж}{{\selectfont\char198}}1
 	{З}{{\selectfont\char199}}1
 	{И}{{\selectfont\char200}}1
 	{Й}{{\selectfont\char201}}1
 	{К}{{\selectfont\char202}}1
 	{Л}{{\selectfont\char203}}1
 	{М}{{\selectfont\char204}}1
 	{Н}{{\selectfont\char205}}1
 	{О}{{\selectfont\char206}}1
 	{П}{{\selectfont\char207}}1
 	{Р}{{\selectfont\char208}}1
 	{С}{{\selectfont\char209}}1
 	{Т}{{\selectfont\char210}}1
 	{У}{{\selectfont\char211}}1
 	{Ф}{{\selectfont\char212}}1
 	{Х}{{\selectfont\char213}}1
 	{Ц}{{\selectfont\char214}}1
 	{Ч}{{\selectfont\char215}}1
 	{Ш}{{\selectfont\char216}}1
 	{Щ}{{\selectfont\char217}}1
 	{Ъ}{{\selectfont\char218}}1
 	{Ы}{{\selectfont\char219}}1
 	{Ь}{{\selectfont\char220}}1
 	{Э}{{\selectfont\char221}}1
 	{Ю}{{\selectfont\char222}}1
 	{Я}{{\selectfont\char223}}1
 	{і}{{\selectfont\char105}}1
 	{ї}{{\selectfont\char168}}1
 	{є}{{\selectfont\char185}}1
 	{ґ}{{\selectfont\char160}}1
 	{І}{{\selectfont\char73}}1
 	{Ї}{{\selectfont\char136}}1
 	{Є}{{\selectfont\char153}}1
 	{Ґ}{{\selectfont\char128}}1
}
\newcommand{\angstrom}{\buildrel _{\circ} \over {\mathrm{A}}}
\numberwithin{equation}{subsection}
\pagestyle{fancyplain}
\fancyhf{}

\renewcommand{\headrulewidth}{0pt}
\rfoot{\fancyplain{}{\centering \thepage}} %нумерация страниц

\linespread{1.3}
\floatname{algorithm}{Алгоритм}

\addto\captionsrussian{ \renewcommand{\contentsname}{ СОДЕРЖАНИЕ}}
\addto\captionsrussian{ \renewcommand\refname{СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ}}

% прилоение
\addto\captionsrussian{ \renewcommand\appendixname{Приложение}}
\makeatletter
\def\redeflsection{\def\l@section{\@dottedtocline{1}{1.5em}{7.8em}}}
\renewcommand\appendix{\par
\setcounter{section}{0}%
\setcounter{subsection}{0}%
\def\@chapapp{\appendixname}%
\addtocontents{toc}{\protect\redeflsection}
\def\thesection{\appendixname\hspace{0.2cm}\@arabic\c@section}}
\makeatother
% /прилоение
% new commands
\newcommand\sign[1]{sign(#1)}



% подрисуночная подпись

\addto\captionsrussian{\renewcommand{\figurename}{Рисунок}}
\makeatletter
\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \hbox to\textwidth{\hfill\parbox{1\textwidth}{\centering #1 - #2}\hfill}
  \vskip\belowcaptionskip}
\makeatother

% новый уровень
\titleclass{\subsubsubsection}{straight}[\subsection]

\newcounter{subsubsubsection}[subsubsection]

\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}
\renewcommand\theparagraph{\thesubsubsubsection.\arabic{paragraph}}
\renewcommand\thesubparagraph{\theparagraph.\arabic{subparagraph}}

\titleformat{\subsubsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{5}{\z@}%
  {3.25ex \@plus1ex \@minus.2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{6}{\parindent}
  {3.25ex \@plus1ex \@minus .2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\def\toclevel@subsubsubsection{4}
\def\toclevel@paragraph{5}
\def\toclevel@paragraph{6}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
\def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
\def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
\@addtoreset{subsubsubsection}{section}
\@addtoreset{subsubsubsection}{subsection}
\@addtoreset{paragraph}{subsubsubsection}
\makeatother
\setcounter{secnumdepth}{6}
\setcounter{tocdepth}{6}

% названия с красной строки
\titlespacing*{\section}{\parindent}{1ex}{1em}
\titlespacing*{\subsection}{\parindent}{1ex}{1em}
\titlespacing*{\subsubsection}{\parindent}{1ex}{1em}
\titlespacing*{\subsubsubsection}{\parindent}{1ex}{1em}
%добавить точку после номера
\makeatletter
\renewcommand{\@seccntformat}[1]{\indent \csname the#1\endcsname.\quad}
\makeatother

\begin{document}
\input{title.tex}
\setcounter{page}{2}

\titleformat*{\section}{\centering\bfseries\Large}
\tableofcontents
\titleformat*{\section}{\bfseries\Large}


\newpage
% ---------------------section 1 -----------------------
  \section*{\centering ВВЕДЕНИЕ}
  \addcontentsline{toc}{section}{\protect\numberline{}ВВЕДЕНИЕ}%
  \input{introduction.tex}
  \newpage
\section{Литературный обзор}
  \subsection{Атомный фактор рассеяния}
    \input{atom_factor.tex}
  \subsection{Структурный фактор рассеяния}
    \input{structure_factor.tex}
  \subsection{Влияние температуры. Тепловой фактор Дебая - Валлера}
    \input{temp_factor.tex}
  % \input{kinematic_theory.tex}
  \subsection{Динамическая теория рассеяния}
    \subsubsection{Симметричная схема дифракции}
      \input{symmetric_case_dif.tex}
    \subsubsection{Асимметричная схема дифракции}
      \input{assymetric_case_dif.tex}
    \subsubsection{Рентгеновская поляризуемость в среде}
      \input{x_ray_polarizability.tex}
    \subsubsection{Собственная кривая отражения (КДО)}
      \input{rocking_curve_theory.tex}
    % \subsubsection{Нарушенный слой}
      % \input{broken_layer.tex}
  \subsection{Пьезоэлектрический эффект}
    \input{piezo_method.tex}

% ---------------------section 2 -----------------------
\newpage
\section{Оборудование и методы}
  \subsection{Оборудование. Трехкристальный рентгеновский спектрометр}
    \input{spectrometer.tex}
  \subsection{Исследуемые образцы}
      \input{samples.tex}
  \subsection{Алгоритмы расчетов и методики измерений}
    \input{calc_algorithms.tex}
    \subsubsection{Функция источника}
      \input{source_section.tex}
    \subsubsection{Функция щелевых коллиматоров}
      \input{slits_section.tex}
    % \subsubsubsection{Дифракция на щели}  Cowley1979ru на странице 47
    \subsubsection{Собственная кривая отражения}
      \input{rocking_curve.tex}
    \subsubsection{Отражение от одного кристалла}
      \input{single_crystal.tex}
    \subsubsection{Методика моделирования двухкристальных кривых дифракционного отражения}
      \input{what_is_double_KDO.tex}
    \subsubsubsection*{Выражение для расчета двухкристальных КДО}
      \input{double_crystal_equation.tex}
    \subsubsection{Методика моделирования трехкристальных кривых дифракционного отражения}
      \subsubsubsection{Карта рассеяния в прямом пространстве}
        \input{what_is_triple_KDO.tex}
      \subsubsubsection{Карта рассеяния в обратном пространстве}
        \input{reciprocal_lattice.tex}
    \subsubsection{Методика расчета пьзоэлектрических констант по данным дифракции}
      \input{piezo.tex}
      \subsubsection{Методика экспериментального определения
      пльзоэлектрических констант по данным рентгеновской дифракции}
        \subsubsubsection{Статический метод}
            \input{piezo_classic.tex}
        \subsubsubsection{Времяразрешающий метод}
            \input{slope_diff_piezo.tex}


% ---------------------section 3 -----------------------
\newpage
\section{Результаты и обсуждения}
  \subsection{Аппаратная функция}
  \subsubsection{Угловая составляющая аппаратной функции}
    \input{zero_cryst_exp.tex}
  \subsubsection{Спектральная составляющая аппаратной функции}
      \input{scan_spectra.tex}
  \subsection{Двухкристальные КДО}

    \subsubsection{Бездисперсионная схема}
    \input{non_dispersion_cal_an_exp.tex}
    \subsubsection{Дисперсионная схема}
    \input{dispersion_cal_an_exp.tex}
    \subsubsection{Учет асимметрии отражения}
    \input{assymetric_cal_an_exp.tex}
  \subsection{Влияние внешнего электрического поля на двухкристальные КДО}
    % \input{piezo_theory.tex}
    \subsubsection{Изменение профиля КДО при пьезоэффекте}
      \input{shape_kdo.tex}
    \subsubsection{Угловой сдвиг КДО при пьезоэффекте}
      \input{angle_move_kdo.tex}
    \newpage

    \section*{ \centering ВЫВОДЫ }
    \addcontentsline{toc}{section}{\protect\numberline{}ВЫВОДЫ}%

      \input{zakluchenie.tex}
      \newpage

      \section*{ \centering ЗАКЛЮЧЕНИЕ }
      \addcontentsline{toc}{section}{\protect\numberline{}ЗАКЛЮЧЕНИЕ}%
      \input{vyvody.tex}

\newpage
  \begin{center}
  \input{bibliography.tex}
  \end{center}
  \addcontentsline{toc}{section}{\protect\numberline{}СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ}%

\newpage
\appendix
  \input{appendix_1.tex}
  % \input{appendix_2.tex}
  \input{appendix_3.tex}
  \input{appendix_4.tex}
  % \input{appendix_5.tex}
  % \input{appendix_6.tex}
  % \input{appendix_7.tex}

\end{document}
