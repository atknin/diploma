\begin{center}
  \section{}%Выражение для поляризуемости}
\end{center}

\label{sec:polarizability}
% ~\ref{sec:wave_equation}
Приведем упрощенный вывод для Фурье компонент  $\chi_h$  для рентгеновской
поляризуемости в среде  $\chi(\vec{r})$. Если в какой либо точке находится электрон,
то уравнение его движения под действием электромагнитной волны,
исходя из второго закона Ньютона, запишется в виде \cite{iveronova1972}.
\begin{equation}
  \ddot{x}+ k\dot{x} + \omega_0^2 x = \frac{e}{m}E_0e^{i\omega t}
 \end{equation}
Откуда смещение этого заряда
\begin{equation}
  x = \frac{e}{m} \frac{E_0e^{i\omega t}}{\omega_0^2 - \omega^2+i\omega t}
 \end{equation}
где $\omega_0 $ - собственная частота колебания электрона (частота электронного перехода), $\omega$ - частота рентгеновского излучения.

Поляризация единицы объема в заданной точке пространства $P$ определяется из условия
$P = \frac{\sum e x}{\Delta V}$. Суммирование проводится по всем зарядам в
некотором малом объеме  $\Delta V$.

Для рентгеновских лучей обычно $\omega_0^2 << \omega^2$, поэтому
\begin{equation}
  4\pi P = - \frac{4\pi e^2}{m\omega^2}\frac{\Delta N}{\Delta V} E_0 e^{i\omega t} = -\frac{e^2 \lambda^2}{m \pi c^2} \rho E_0 e^{i\omega t}
 \end{equation}
где $\Delta N$ - число зарядов в объеме $\Delta V$;
$\rho = \frac{\Delta N}{\Delta V}$ - электронная плотность в заданной точке пространства.


\begin{equation}
  \chi_h = -\frac{e^2 \lambda^2}{m \pi c^2}  \rho = -\frac{e^2 \lambda^2}{m \pi c^2} \frac{F_h}{V}
 \end{equation}
 где, $ F_h = \sum_{n} f_n \cdot e^{-2\pi i\vec{h}\cdot \vec{r}_n}= \sum_{n} f_n \cdot e^{- 2 \pi i (hx_n+ky_n+lz_n)}$ -
 структурная амплитуда (раздел ~\ref{sec:structure_factor}),
 коэффициент $h$ в $F_h$ - означает конкретные значения индексов {hkl}; $V$ - объем элементарной ячейки кристалла.

\newpage
\begin{center}
\section{}%Волновое уравнение
\end{center}

 \label{sec:wave_equation}
  воспользоваться операторным тождеством
 \begin{equation}
   rot \quad rot \vec{E} = grad \quad div \vec{E} - \Laplace \vec{E}
  \end{equation}


% \begin{lstlisting}[language=Python]
% import numpy as np
%
% def incmatrix(genl1,genl2):
%     m = len(genl1)
%     n = len(genl2)
%     M = None #to become the incidence matrix
%     VT = np.zeros((n*m,1), int)  #dummy русский
%
%     #compute the bitwise xor matrix
%     M1 = bitxormatrix(genl1)
%     M2 = np.triu(bitxormatrix(genl2),1)
%
%     for i in range(m-1):
%         for j in range(i+1, m):
%             [r,c] = np.where(M2 == M1[i,j])
%             for k in range(len(r)):
%                 VT[(i)*n + r[k]] = 1;
%                 VT[(i)*n + c[k]] = 1;
%                 VT[(j)*n + r[k]] = 1;
%                 VT[(j)*n + c[k]] = 1;
%
%                 if M is None:
%                     M = np.copy(VT)
%                 else:
%                     M = np.concatenate((M, VT), 1)
%
%                 VT = np.zeros((n*m,1), int)
%
%     return M
% \end{lstlisting}
